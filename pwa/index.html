<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="修繕報告">
  <meta name="theme-color" content="#1a73e8">
  <title>mt. inn 修繕報告</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- ヘッダー -->
  <header class="app-header">
    <h1>mt. inn 修繕報告</h1>
  </header>

  <!-- メインフォーム -->
  <main class="app-main">
    <form id="repairForm" novalidate>
      <!-- 報告者名 -->
      <div class="form-group">
        <label for="reporter">報告者</label>
        <select id="reporter" required>
          <option value="">選択してください</option>
          <option value="村松">村松</option>
          <option value="鈴木">鈴木</option>
          <option value="佐藤">佐藤</option>
          <option value="田中">田中</option>
          <option value="高橋">高橋</option>
          <option value="その他">その他</option>
        </select>
        <input type="text" id="reporterCustom" class="hidden" placeholder="名前を入力">
      </div>

      <!-- 写真撮影 -->
      <div class="form-group">
        <label>写真（最大3枚）</label>
        <div class="photo-section">
          <div id="photoPreview" class="photo-preview"></div>
          <button type="button" id="addPhotoBtn" class="btn-photo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <path d="M21 15l-5-5L5 21"/>
            </svg>
            写真を追加
          </button>
          <input type="file" id="photoInput" accept="image/*" capture="environment" class="hidden" multiple>
        </div>
      </div>

      <!-- 説明テキスト + 音声入力 -->
      <div class="form-group">
        <label for="description">修繕内容</label>
        <div class="textarea-wrapper">
          <textarea id="description" rows="5" placeholder="修繕が必要な箇所の説明を入力..."></textarea>
          <button type="button" id="voiceBtn" class="btn-voice" title="音声入力">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </button>
        </div>
        <div id="voiceStatus" class="voice-status hidden"></div>
      </div>

      <!-- 送信ボタン -->
      <button type="submit" id="submitBtn" class="btn-submit">
        送信する
      </button>
    </form>

    <!-- ローディング -->
    <div id="loading" class="loading hidden">
      <div class="spinner"></div>
      <p>送信中... AI解析・稟議書生成を行っています</p>
      <p class="loading-note">30秒〜1分ほどかかります</p>
    </div>

    <!-- 成功メッセージ -->
    <div id="success" class="result-message success hidden">
      <div class="result-icon">&#10003;</div>
      <h2>送信完了</h2>
      <p id="successMessage"></p>
      <button type="button" id="newReportBtn" class="btn-submit">新しい報告を作成</button>
    </div>

    <!-- エラーメッセージ -->
    <div id="error" class="result-message error hidden">
      <div class="result-icon">!</div>
      <h2>エラー</h2>
      <p id="errorMessage"></p>
      <button type="button" id="retryBtn" class="btn-submit">再試行</button>
    </div>

    <!-- オフラインキュー通知 -->
    <div id="offlineNotice" class="offline-notice hidden">
      <p>オフラインのため、報告をキューに保存しました。オンライン復帰時に自動送信されます。</p>
    </div>
  </main>

  <script src="js/camera.js"></script>
  <script src="js/voice.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
